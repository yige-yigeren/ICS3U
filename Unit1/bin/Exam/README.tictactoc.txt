I found that the old AI matching code was sometimes buggy and the process was cumbersome and difficult to maintain.
So I re-wrote an AI.
The old AI uses the judgment logic of identifying victory-threat-potential threat-weight recommendation
New AI to try to win - Can the try be defeated - Can the try be defeated by a potential threat in the next step - Updated weight judgment logic
But the old AI works fine, at least it's almost impossible to beat, so I keep it